<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Special Reels for Tanu</title>

  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#fff7fb;
      --bg2:#eef9ff;
      --accent:#ff6ec4;
      --accent2:#a485ff;
      --text:#352033;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family:"Poppins",system-ui,Roboto,Arial,sans-serif;
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      padding:36px 20px 80px;
    }

    .wrap{ max-width:1200px; margin:0 auto; }
    h1{
      font-family:"Pacifico",cursive;
      text-align:center;
      color:var(--accent);
      margin:6px 0 6px;
      font-size:36px;
    }
    p.lead{ text-align:center; color:#6b4a56; margin:6px 0 26px }

    /* Grid: three columns */
    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:28px;
      align-items:start;
    }

    .reel-card{
      display:flex;
      flex-direction:column;
      align-items:stretch;
      gap:12px;
    }

    .reel-label{
      width:36px;
      height:36px;
      border-radius:999px;
      background: #fff;
      color:#333;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:700;
      box-shadow:0 6px 18px rgba(0,0,0,0.08);
      margin-left:8px;
      font-size:14px;
    }

    /* frame for video - keeps 9:16 aspect ratio */
    .reel{
      background:#000;
      border-radius:14px;
      padding:12px;
      box-shadow:0 24px 60px rgba(17,24,39,0.06);
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
    }

    /* using aspect-ratio to get 9:16 tall video */
    .reel-frame{
      width:100%;
      aspect-ratio: 9 / 16; /* tall vertical */
      background:#000;
      border-radius:10px;
      overflow:hidden;
      display:block;
      position:relative;
    }

    video.reel-video{
      width:100%;
      height:100%;
      display:block;
      object-fit:contain; /* contain so it doesn't crop; letterbox if necessary */
      background:#000;
      outline:none;
      -webkit-user-select:none;
      user-select:none;
    }

    /* play button below each video */
    .play-btn{
      margin:0 auto;
      padding:10px 18px;
      border-radius:999px;
      border:none;
      background:linear-gradient(90deg,var(--accent2),var(--accent));
      color:white;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 10px 26px rgba(117,198,255,0.08);
      transition:transform .12s ease;
      width:160px;
    }
    .play-btn:active{ transform:translateY(1px) }
    .play-btn.small{ width:120px; padding:8px 14px; font-size:14px }

    /* global action buttons */
    .actions{
      display:flex;
      gap:16px;
      justify-content:center;
      margin-top:28px;
    }
    .btn{
      padding:12px 20px;
      border-radius:999px;
      border:none;
      font-weight:700;
      cursor:pointer;
      background:linear-gradient(90deg,var(--accent2),var(--accent));
      color:white;
      box-shadow:0 10px 26px rgba(117,198,255,0.08);
    }
    .btn.ghost{ background:#fff;color:var(--text); border:1px solid rgba(0,0,0,0.06) }

    footer{ text-align:center; margin-top:30px; color:#6b4a56 }

    /* responsive */
    @media(max-width:980px){
      .grid{ grid-template-columns: repeat(2, 1fr) }
    }
    @media(max-width:640px){
      .grid{ grid-template-columns: 1fr; }
      .play-btn{ width:100% }
    }
  </style>
</head>
<body>
  <div class="wrap" role="main">
    <h1>Special Reels for Tanu</h1>
    <p class="lead">Tap play on any video. When one plays the others will auto-pause. Click the video area to pause/play. Sound unmutes when you explicitly play a video.</p>

    <div class="grid" id="reelGrid">
      <!-- Reel 1 -->
      <div class="reel-card" aria-label="Reel 1">
        <div class="reel-label">1</div>
        <div class="reel">
          <div class="reel-frame">
            <video class="reel-video" id="vid-0" playsinline muted preload="metadata" src="video1.mp4"></video>
          </div>
        </div>
        <button class="play-btn" data-index="0" aria-controls="vid-0" aria-pressed="false">â–¶ Play</button>
      </div>

      <!-- Reel 2 -->
      <div class="reel-card" aria-label="Reel 2">
        <div class="reel-label">2</div>
        <div class="reel">
          <div class="reel-frame">
            <video class="reel-video" id="vid-1" playsinline muted preload="metadata" src="video2.mp4"></video>
          </div>
        </div>
        <button class="play-btn" data-index="1" aria-controls="vid-1" aria-pressed="false">â–¶ Play</button>
      </div>

      <!-- Reel 3 -->
      <div class="reel-card" aria-label="Reel 3">
        <div class="reel-label">3</div>
        <div class="reel">
          <div class="reel-frame">
            <video class="reel-video" id="vid-2" playsinline muted preload="metadata" src="video3.mp4"></video>
          </div>
        </div>
        <button class="play-btn" data-index="2" aria-controls="vid-2" aria-pressed="false">â–¶ Play</button>
      </div>
    </div>

    <div class="actions" role="region" aria-label="Actions">
      <button id="Memorylane" class="btn">Back to memory lane</button>
      <button id="pauseAll" class="btn ghost">Pause All</button>
      <button id="nextSurprise" class="btn">Cake Cutting time â†’</button>
    </div>

    <footer>Enjoy the reels â€” click the video area to toggle play/pause. ðŸŽ¬</footer>
  </div>

  <script>
    // references
    const videos = Array.from(document.querySelectorAll('video.reel-video'));
    const playButtons = Array.from(document.querySelectorAll('.play-btn'));
    const pauseAllBtn = document.getElementById('pauseAll');
    const playSequenceBtn = document.getElementById('playSequence');
    const nextSurprise = document.getElementById('nextSurprise');

    // helper: pause all except index (if provided)
    function pauseAll(exceptIndex = -1){
      videos.forEach((v, i) => {
        if(i === exceptIndex) return;
        if(!v.paused){
          v.pause();
          updateButtonState(i, false);
        }
        v.muted = true; // keep others muted
      });
    }

    // update play button label & aria
    function updateButtonState(index, playing){
      const btn = playButtons[index];
      if(!btn) return;
      btn.textContent = playing ? 'â¸ Pause' : 'â–¶ Play';
      btn.setAttribute('aria-pressed', String(!!playing));
    }

    // toggle a particular video by index
    function toggleVideo(index, explicit = true){
      const v = videos[index];
      if(!v) return;
      if(v.paused){
        // start playing this one
        pauseAll(index);
        v.muted = false;        // unmute the explicitly started video
        v.play().catch(e => {
          // autoplay may fail; ignore
          console.warn('play failed', e);
        });
        updateButtonState(index, true);
      } else {
        v.pause();
        updateButtonState(index, false);
      }
      // if explicit (user clicked), ensure only this one is unmuted
      if(explicit){
        videos.forEach((other, i)=> {
          if(i !== index) other.muted = true;
        });
      }
    }

    // attach click handlers to buttons
    playButtons.forEach(btn => {
      const idx = Number(btn.dataset.index);
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleVideo(idx, true);
      });
      btn.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleVideo(idx, true); }
      });
    });

    // click on video area toggles as well (explicit)
    videos.forEach((v, i) => {
      // clicking video toggles
      v.addEventListener('click', () => toggleVideo(i, true));

      // when user presses Space/Enter while focusing video container
      v.addEventListener('keydown', (e) => {
        if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); toggleVideo(i, true); }
      });

      // when a video ends, mark button state & optionally continue sequence if in sequence mode
      v.addEventListener('ended', () => {
        updateButtonState(i, false);
        // if sequence mode active, sequence logic will handle moving to next
      });

      // keep UI in sync if paused by other actions
      v.addEventListener('pause', () => updateButtonState(i, false));
      v.addEventListener('play', () => updateButtonState(i, true));
    });

    // Pause All button
    pauseAllBtn.addEventListener('click', ()=>{
      videos.forEach((v,i)=> {
        v.pause();
        v.muted = true;
        updateButtonState(i, false);
      });
    });

    // Sequence play: play 0 then 1 then 2 automatically
    let seqActive = false;
    let seqIndex = 0;
    let seqAbort = false;

    function playSequence(start=0){
      seqActive = true;
      seqAbort = false;
      seqIndex = start;

      function playNext(){
        if(seqAbort || seqIndex >= videos.length){
          seqActive = false;
          return;
        }
        const v = videos[seqIndex];
        // pause others
        pauseAll(seqIndex);
        v.muted = false;
        // play and wait for ended
        v.play().catch(()=>{});
        updateButtonState(seqIndex, true);

        // when this video ends or is paused by user, continue to next automatically
        const onEndedOrPause = () => {
          v.removeEventListener('ended', onEndedOrPause);
          v.removeEventListener('pause', onEndedOrPause);
          // only advance if not aborted and video actually reached end (ended) or user paused -> still advance
          seqIndex++;
          if(!seqAbort) setTimeout(playNext, 300); // small gap
        };

        v.addEventListener('ended', onEndedOrPause);
        v.addEventListener('pause', onEndedOrPause);
      }

      playNext();
    }

    Memorylane.addEventListener('click', ()=> {
      // pause and mute all before leaving
      videos.forEach(v=>{ try{ v.pause(); v.muted = true; }catch(_){} });
      // small delay ensures audio stops
      setTimeout(()=> window.location.href = 'memorylane.html', 80);
    });

    // Next surprise navigation
    nextSurprise.addEventListener('click', ()=> {
      // pause and mute all before leaving
      videos.forEach(v=>{ try{ v.pause(); v.muted = true; }catch(_){} });
      // small delay ensures audio stops
      setTimeout(()=> window.location.href = 'cake.html', 80);
    });

    // Accessibility: keyboard support to focus video card
    document.querySelectorAll('.reel-card').forEach((card, idx) => {
      // make focusable
      card.tabIndex = 0;
      card.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.key === ' '){
          e.preventDefault();
          toggleVideo(idx, true);
        }
      });
    });

    // ensure initial UI states
    videos.forEach((v, i) => updateButtonState(i, false));

    // Optional: unmute on user gesture anywhere (safety)
    // We'll unmute only the explicitly played video above; but ensure clicking on page won't arbitrarily unmute all.
    // No global autoplay unmute to avoid browser blocks.

  </script>
</body>
</html>
